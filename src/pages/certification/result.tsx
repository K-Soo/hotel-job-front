import React from 'react';
import { GetServerSideProps, InferGetServerSidePropsType, GetServerSidePropsContext } from 'next';
import { parseBody } from 'next/dist/server/api-utils/node/parse-body';
import Image from 'next/image';
import environment from '@/environment';

// phone_no: '',
// res_msg: '����ó��',
// DI: '',
// year: '0',
// user_name_url_yn: '',
// cert_otp_use: 'N',
// CI_ENC_YN: '',
// comm_id: 'SKT',
// sex_code: '',
// safe_guard_yn: 'N',
// PRE_USE_YN: 'N',
// day: '0',
// site_key: '',
// web_siteid_hashYN: 'Y',
// dn_hash: '06C871A425F6E7E849402751BDA1626583E0DBD7',
// res_cd: '0000',
// DI_URL: '',
// month: '0',
// site_url: 'www.hotel-job-connect.com',
// Ret_URL: 'https://hotel-job-connect.com/certification/result',
// kcp_merchant_time: '',
// info_code: '54C5E32A26BF3C878F4C4FABC315EE1B',
// user_name: '',
// server_hash: '',
// cert_02_yn: 'Y',
// log_trace_no: 'AKWH3BJa1wVnOBJp',
// param_opt_1: 'opt1',
// Ret_Noti: '',
// reg_dt: '',
// param_opt_3: 'opt3',
// param_opt_2: 'opt2',
// cert_enc_use: 'Y',
// enc_cert_data2: '.1.62BF722823C8704D146C4B4A6D4F3399AD13ACB194AA6C939ACFA05C6D11EABFDFF0B8545B549ABD7A99C7339BA979D52675C36673E37DBB382450A3535F62DB8ACE45269FB61EAB41E987FCD42F4A04D3C68BA6BD673C9740A70E51E5FAC865007B2BDB0470A42AEFEC5D430F8047C2E6E441B632511E5D069875BE4F865FBE1A4942104F65931B17DB9483C08E6F117D071A0BDA3CE3929F4DFC0EA4B5409ECD22B355103447D5FF41A976AFADD4B8DB53A03DAE4ECD7F45EB251F7435D19E500774EC2DCAA7E47F9CEA079D59E0D5E1B39321A9477F02000C7928664689CE9B7A2A3B74D4F34DDA103523B76A50C5EA0AE492D19683A52F0D8919D1EB3A0D82B73B19BE8F9151F7E4D1DAA42E393108B2EE0EDD100D7ADDE3A42C8EA03369BAF13B6935AD38CB632BF5FB1C9FD55C1691AC796B995A085975A1DEC6E5888C73B559F58EABAA1641CC7941EBE96290B1EFD6F03F7DBBD62953903101B0762DD964310288BD1D21036836483268866AB11D9FB20708192C07768CF58B3825EC7B63E0F568BD5FA3E53969CF2FEAEE4C74BB6545E329EAD63B9E75503FFC1B67DC26C731D6DC098464EA6F26C86ABBB4FC1E5C16630A9F0FC7B5C2455F181EA0ECFABF25FC6D1A84A75ACF1EB917FEBCD2253D9E1F526DB4E7480A0E14D06EAF46F27A70BD75BD142B16BD13FDBF9E035350969E6F014FA43CEF57E26F6EBB7EF9643892A4B5464D9184B8A4540232D5193957202DD0ACF1D8EED47C23C1020863EC93355ECE7BE7DB61D0ADACFF25841EA3EADEDC7BC1478ACBC1F562CA79A97A5D80161CC8D406625D08539D7BF686B5F17F927C4C809258BB5DCD7C6297CBFC3538868305449A157D14815B696B2F6CBFC6DDE6899536621F057CC18CE589284690469DE44406B40F3A2AA682142F5D03788EE4952E148C7E4DECD5A9BD4A974B7E123D39E20A8AF5B05B7CDF0A1B6A553E647AE7B97C963E2878A23E4C9B4CEB268341B7155CE10AACD2043961060C578E113AD70B350BEB9C48F5F139CD533D42102D9C30F1874A5FAA51972278D68FC24068F723575503196AE4BE71AE578D09650E0DD53AB84897EA9516EB7815B03FB6CDAA804552172FDF781A6E157AE732270C894CF389064E2C6CE87DCDACE4D52979E89683BB238667C213AF93BCBB0419C16A7C9FF198D7C5B470962D8D6E6B7ABA1644413BBD6713BB823C711800E8CA2A2B4275265F80FCF402C41CCF91151A0A782FCBFC46395ADC648613BBC38951FA4BCE1C21C93F8B7BA8620D9EE6E11B7FA74A14EB2A3F59914479C9F275C53F0806518F9651886AB2C5688EC915F12A37A6E2473E19659F0A1C8F7432CCC9C64E2B53CF0EE687087AC340EB055BE780A76189D93455C59A6701806EDE1E42B6B3BD280CBA52AE0D25CA7DEA381332091F3B9CA85DE84EB065F66CB063C42A772E77D17113B57C897CA7447CE857EE11DCC4BB4FAF0C2789F1C04DF37382FA5687F715E377A4412DAB55505BCBC44B0A74C3ECA89390A7921424D72ACC53966381D31D88CE0B8B3AA5F2DAB126651B42DA6B04B821F06CAD464C91FFA34D0507771FF0F049CFBC60A3003224F8A46839201F36CD92F297C78215BCE4C18765474C10D76BBF08E025EA1D1D08A9223612D78B02EF50A49D7C3DFC13B9F5EDF7F8BF44CD8B7A79CB8057348F88E4E8E38240FF1C4CFD96D75BE156555474F3828A854F633222D6FD4A0ABDE26B63ED393B97DE1B9196BA7219EF8A4E935DEDA030822FBF340BA58902EE9655ABAEADE24025DDF236F96433B72BB9507B3974DCC2AA734F555C944446A4DEA303F08FD77EAD2B2C6EB1FF5804FC3A67A4DD57642419E680DBA2747DBE03D02BD13A5C8E4B818F3C7B4572B5626E47EFAF484EEA13C4DE9EFC369EC6B52893A346E269C0C8F23B98AF09AD2E0C72592EB2E694FC9FC19EFFE53C23E0DBAF7CFEDC2014A3125A7CEBB8C32966D2F76BEB84FA541711353DFAA60D43B5D3F5EBD5965A0503DBAD024D42BB0CA34271D00F5E1251C36EB5BA20372F5F067801759311106D628BF90BF4860EFF8CDF2ADF07B65A7211F800247A9D2AF375B2DB370CAC08888FFAD20AE4DA87F3E071D9C4EF21580A28B9E945E8013B51EADDEAAEE530599E2FF546A7FB349FB8A9072E1790CEF6F40022F4789372D903DD9E2A9E1DEEE0DDA08CD3CF8D7B02933E73FD8383A1.WNKSoWIQNTQGo6FgF1gS2AfUmxks1wreH67qTa-9qFy4-Pl65iInSS30jT2SWZZt_4DXYuQ6phEv5ghgGiXnuhydEEKxb_r27Kw-YneCibE-ZPEuCta3K5x_9Sk-PoFoUSXVR-1

// CI: '';
// CI_ENC_YN: 'Y';
// CI_URL: '';
// DI: '';
// DI_URL: '';
// Logo_URL: '';
// PRE_USE_YN: 'N';
// Ret_Noti: '';
// Ret_URL: 'https://hotel-job-connect.com/certification/result';
// auth_tx_id: '502jUyTcum';
// birth_day: '';
// cert_01_yn: 'Y';
// cert_02_yn: 'Y';
// cert_enc_use: 'Y';
// cert_enc_use_ext: 'Y';
// cert_method: '01';
// cert_no: '25257463818650';
// cert_otp_use: 'Y';
// comm_id: 'SKT';
// day: '0';
// dn_hash: '7F9AEEC84915710B864F3F5C5F96F239388CFD53';
// enc_cert_data2: '.1.4E5E4537436303943BC2C7E15D72E312932110024ECE346FA7F9BE93E2069D0AF9448DC1F5E251E427AA64FE50349AF3CD894FEE76BCE44867837E7BC5744AC9D698D4578E01D32E38B93C0AC94718155301722413CFBC30519357152E2EF788F73FA5B250D1EB34936FF87F34ED706AFCB6DDDA5C249286B7C58012BDF2B6462927D75A19FDA47C992AD5B739165DF99A7AF87FC7A0793BAD203D9D3151606A1197B974E8FF916FEBFE315B39F8784469738F9D5796D9DFD69C44C064CB18D842F17388B19BCB0FFC1761BE84134279D66DF870A82D9C66A8180899C708AC74886472E98BE9851FC9837CB35F20379A5D745C32E31473535D8A591F3AB00CBE9C10F60FC108B048D28F8F4B9A6497C761A96984220E16E24FCC7C1088D82F71E41DBCF9BDD6365C358B4C01EB8F4AC5A4872CBAECFC441DE4A541E85476D42F7CA2F90A6B2AC0FD077BE480CA4C276B70FE930212222721DFF2C3D9D1ACF9AB592CAC40EB89A16BF08FD6FA22ADE0F81700E35B34E852D127DCA28C932A8D02DEC9278784BABFF50F16BDF4374281E11926357F313CA20612BA16CB459F0C7F9270CA5DFFB45097871607CA45B6D4F8AD85648674B6475197EB118988D7A161E4BFCD9295EADB22755871D59A5B02A65C39664530D54A10AF2107ED22574F79914225EE1880F1A3E9CDEFCD353995CC35B8C7193DE1649780232DFEA04EBAB8D42369B50C9CEC67E831ADDBC7FABDA071F6A3C4721DBAB789B3FB0414E7A7DCCADB08C86BD8F0A4E6D2C652659B985A2BBB388B22B9E4F1A77E950A72A1CE9216D973902470F936601E0E90D1B3329F26C60396D7DC214AA9D7F0D051A976908C5A06552F404865A48CBCEEC9CBB726FA47D85167D479E5A0F06FAAFB9DCBFE50D3BE1E5CEE6BE8DAF72E2F4940AFF64C9EE6D8D3EFFB97AD49155CB6DDE1857B0B0178894AE6CFA3FB242AB9EBA82FC4E15CB75453BC78542D0FC6668E437964E4C9AB63A7758DBBA48DF1BD162FF660970ACA831C2E3C42723A1770C6A820F5C8CAF2150DEEA00A99DC2ADB1CC03E27F748D0B0B1BA531A91C0D08A7DA651BC16852A2D2CA8FFD58638714B21158E1B35DCCC6E0D1FDE447F0B7BB2212CE1258E73FAF8459A29D143369AF6E658223E2C1F0E33A751B12E76CC49CEE43297465EE6B126AB61B76E29411EBC5512838A00B6C37D0347E540F2D75F30D83C346CA099D4825A491D9E7CBECEB163A1C6A89AF4545D71CE0F1FB167AC49071BD71683A81502C1443928260682D05C5DBE08566F4E1DD412D545E644F9BB78C975D4EE9669E652538E5A7FA14B7E230F643C25F01C378BD2394B307B1B9DCAE0B824B79537977C9A64AFC41EEFF52062B049104250E70B04CC1B1EA8E62698D03BEE95F7E1C7B7F61E94BEC7CBBAC1BA2292ADB33DC8421970277A0DFD2CD57A68D4CC5B6478E66B1B44CA61495CC14423288250DF757BC0F129ECC7D3D8986FF785EBE3EFDDC41FAC4C8F7AFAA4341C88B4C7FA68303C4F704021D2F22EDA851D3206CBE6A1BB398E850BD18327A034713785A1E3E656F6D9D33CE06F5656DDFACEAE7CF1DE2BA3CE6477FFAE81852C319B260A5EE28FB8DA3F60F00B371A7DB96D9A56BA29F1C35B965369155D1E13EA2071102A94B0095633136DE6AA2252C657EF08D062102595373C6DFD83BCA084B30786BA8458A559BA8DA4E7AF456D916C5005831007A2B9D4208231DCE68D07AB37F8C7377AA1A202399C5506F8160BD304C4F6FE1B27F2D3B0E4067062A56B9759367BBABF283CA0AE621A1AF2A221EFD6F296780EF7847D4A317F9D1963E21BB453D9BF23FD05F2ABE27CE53A53A659371ADEB2FE7DB3FB8A48524AE97D34049E6F031195AAF65045435A1FE2CE1025362451699DFDB6AE9BE14FAE9A32E42954141606CA29636778DF38D346B0E50E90D80C5EB1F94DB7C70E6909DB9282B35E5F813FAF390247CE8AA96028ADFC20100650E3735CAB1AD66CD5641E6A6B0D08D7DCE245D3DE1A2D12D710A70A109ED60F0D6526FCF7DC4EB4AA93B5597CFBB52E605941D2F1C0AAFF4C9DF09B08E6E897207FF6A472B28CCB2CE29E1AD5C310631A34025BA244121CFE4341FC5EB82634748695C9F1CF84EF7077246F568E58CE856C38E6531A4DDB5E047E88D6FCBB244A340980B4C04257AA85DD9A7876579D3EC3AA7FD2287607E98FE6AF9D.Pk6NNIwGIkzB-4LcOcI7mhYk8SoS_m1aPes9zpc9Jp0WI1yw5QiTdrgnmwKXC6nSkc5UsJsdkhyqr_qlvMKft8bUBOYp3VguBjTCJA5WFTyY9uBXfZl39JBZLQw5WT7UtgigMaBUVpCB1uF_PR5K4DWbK06XKThnjtQ68T4czTu5FWhSjtcqvhsVF2CKMOW95NRiqbJy7XefwI8jQa55ZdbwPNFrEULOdQnoWEWyFLy2BZrZV5bQdZD9xc1EIYTOan-PjG8zCdYfRMA4WJ3axhQqpQ-SVb2ayZCSU-qdPVL73kdPe34HSuV-3apj-48sh1AZTypzULiMU_Uv46JBZg.MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAmO92ZYkJNYMn80Q982_psNFMIS3Zm_oCtEQMfKbap7y3YE9TxCxGWiTlCpsMmmy0WdiJQVJoMLec2Z7O436hSN2praZAQzXVNYq50Y4bhrVZhNlN3KPyM4YjLIldqTuyvgY1xxfrpLLwk1KuDufm5jJf05UcRGsnkWRM6GxhyAqZjTdDYkaP1XXlkMHKi39fPqCoyyF6tlW4byS_mjeVopbFXoCH4DcrVJiO7j9V8oE4ZQiztNPRYr5SoCDOzhGK9zlD4Cz2DMl-XRqrSrvY0-8wLr9bL6UfS9yJPoexXDzcWfrQXIruvCZghg7uwicEqeE6koz2ZXJd62JfbmaQKQIDAQAB.h9YDjI2K6Ol_lO22sFgTwFyov7DCy19dkYq7arJXaKmYf6kNzxmckcuIq5e7V66mpr4eWBv7XrdUhhNQE76Juq4-uJD8g6cKMGNpIs81BSUkpyECXW1pdvlRN6xAlgoQeuyyVWZnVrZqOv38BcMDs7Fh-J1o7MI0r5gCKsZSPt-sexN9ktvNdmmuhC5w2F4l8RVc56xj_tm-F_cqGCYV2Fi7D_NDicUySJu7F2AJJsaSk-mn_519emclBWntTXvhX6iQsthDifpIr3neAG2R_J-Lvjkmcp1fYnATzpT3k3mgYm8JySk2MH2b3GiZb1Ica6YA9SJGPMjkQlhIFkTQ0Q';
// info_code: '54C5E32A26BF3C878F4C4FABC315EE1B';
// kcp_merchant_time: '20250107075022068';
// local_code: '';
// log_trace_no: 'AKWH3lXlIkN2WhvV';
// month: '0';
// ordr_idxx: '2501070750221736203822034';
// param_opt_1: 'opt1';
// param_opt_2: 'opt2';
// param_opt_3: 'opt3';
// per_cert_no: '25257463818650';
// phone_no: '';
// req_tx: 'otp_auth';
// res_cd: '0000';
// res_msg: '����ó��';
// safe_guard_yn: 'N';
// session_id: '';
// sex_code: '';
// site_cd: 'AKWH3';
// site_key: '';
// tx_type: '2600';
// up_hash: 'E5E85B29E3C933C54CE3992994ED707F7BA98B06';
// user_name: '����ȣ';
// user_name_url_yn: '';
// van_sms_yn: '';
// van_tx_id: 'MOGA2501070128241425';
// web_siteid: 'J24122610999';
// web_siteid_hashYN: 'Y';
// year: '0';

export default function ResultCertificationPage({ result }: InferGetServerSidePropsType<typeof getServerSideProps>) {
  console.log('ResultCertificationPage: ', result);
  React.useEffect(() => {
    if (result) {
      window.parent?.postMessage(JSON.stringify({ type: 'CERTIFICATION_SUCCESS', data: result }), environment.baseUrl);
    } else {
      window.parent?.postMessage(JSON.stringify({ type: 'CERTIFICATION_FAIL', data: result }), environment.baseUrl);
    }
  }, [result]);

  return (
    <section style={{ display: 'flex', justifyContent: 'center', alignItems: 'center', height: '100vh' }}>
      <Image src="/images/spinner200px.gif" width={30} height={30} alt="loading" priority />
    </section>
  );
}

export const getServerSideProps: GetServerSideProps = async (context: GetServerSidePropsContext) => {
  try {
    const body = await parseBody(context.req, '1mb');
    return {
      props: {
        result: body,
      },
    };
  } catch (error) {
    return {
      props: {
        result: null,
      },
    };
  }
};
